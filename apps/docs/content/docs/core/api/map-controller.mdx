---
title: MapController
description: The central controller for managing the map instance.
---

# MapController

The `MapController` is the primary interface for programmatically interacting with the map. It wraps the MapLibre instance and provides high-level APIs for state management, layers, and plugins.

You can access the controller via [`useMap`](/docs/core/hooks/map-hooks#usemap) or [`useMapController`](/docs/core/hooks/map-hooks#usemapcontroller).

## Properties

| Property | Type | Description |
| :--- | :--- | :--- |
| `id` | `string` | Unique identifier for this map instance. |
| `isReady` | `boolean` | `true` if the map lifecycle state is 'ready'. |
| `map` | `MapLibreMap` | Access the underlying MapLibre instance. **Throws an error** if the map is not ready. |
| `layers` | [`LayerRegistry`](/docs/core/api/layer-registry) | Manager for adding, removing, and updating layers. |
| `events` | [`EventBus`](/docs/core/api/events) | System for subscribing to and emitting typed events. |
| `style` | [`StyleManager`](/docs/core/api/style-manager) | Manager for map styles and basemaps. |
| `plugins` | [`PluginManager`](/docs/core/api/plugin-manager) | Manager for registered plugins. |
| `interaction` | [`InteractionModeStore`](/docs/core/api/interaction) | Manager for interaction modes (e.g., drawing vs panning). |
| `request` | [`RequestManager`](/docs/core/api/requests) | Manager for making authenticated requests. |
| `auth` | [`AuthManager`](/docs/core/api/requests) | Manager for authentication tokens and sessions. |
| `state` | `StateStore` | Global state manager for the map. |

## Methods

### `awaitReady()`

Waits for the map to fully initialize and load its style. It is safe to await this multiple times.

```typescript
await controller.awaitReady();
console.log('Map is ready to use');
```

**Returns:** `Promise<void>`

---

### `setBasemap(style, options?)`

Changes the map's basemap style while preserving registered layers.

```typescript
await controller.setBasemap('https://demotiles.maplibre.org/style.json');
```

**Parameters:**

- `style` (`string | object`): The style URL or JSON object.
- `options` (`object`, optional):
  - `transformStyle` (`function`): A function to modify the style before application.

**Returns:** `Promise<SetBasemapResult>`

---

### `invalidateSize()`

Forces the map to recalculate its container size. Call this if the container is resized programmatically (though `ResizeObserver` handles most cases automatically).

```typescript
controller.invalidateSize();
```

---

### `destroy()`

Cleanly destroys the map instance, removing all event listeners and DOM elements.

```typescript
await controller.destroy();
```

---

### `serialize()`

Serializes the current map state (style, layers, camera, etc.) into a JSON object.

```typescript
const serializedState = controller.serialize();
console.log(serializedState);
```

**Returns:** `object`

---

### `hydrate(state)`

Applies a previously serialized map state to the current map.

```typescript
const savedState = { /* ... previously serialized state ... */ };
await controller.hydrate(savedState);
```

**Parameters:**

- `state` (`object`): The serialized map state object.

**Returns:** `Promise<void>`
